/*
 * Copyright (c) 2024 CrunchyToast by Log4JExploit
 * Do you keep my non-compiled source code?
 * Then keep this comment.  (View the license)
 */

package github.log4jexploit.crunchytoast.http.endpoint;

import github.log4jexploit.crunchytoast.http.util.Http;
import org.junit.Test;

import java.io.ByteArrayOutputStream;
import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.util.Arrays;

public class HttpEndpointManagerImplTest {


    @Test
    public void testDynamicResource() throws IOException {
        File resource = File.createTempFile("resource", ".txt");
        resource.createNewFile();
        FileOutputStream out = new FileOutputStream(resource);
        byte[] data = new byte[1024 * 1024 * 2];
        for(int i = 0; i < data.length; i++) {
            if(i % 3 == 0)
                data[i] = 2;
        }
        out.write(data);
        out.flush();

        HttpResourceDynamic resourceDynamic = new HttpResourceDynamic(resource, Http.ContentType.BIN);
        System.out.println("Size: "+resourceDynamic.getSize());
        ByteArrayOutputStream stream = new ByteArrayOutputStream();
        stream.write(resourceDynamic.getDataRange(1024 * 1024, 8));
        System.out.println(Arrays.toString(stream.toByteArray()));
    }

}
