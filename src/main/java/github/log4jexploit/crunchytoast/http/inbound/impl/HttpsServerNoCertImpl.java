/*
 * Copyright (c) 2022-2025 CrunchyToast by Log4JExploit
 * Do you keep my non-compiled source code?
 * Then keep this comment.  (View the license)
 */

package github.log4jexploit.crunchytoast.http.inbound.impl;

import javax.net.ServerSocketFactory;
import javax.net.ssl.SSLServerSocketFactory;
import java.io.IOException;
import java.io.UncheckedIOException;
import java.net.InetAddress;
import java.net.ServerSocket;

@SuppressWarnings("unused")
public class HttpsServerNoCertImpl extends HttpServer {

    private ServerSocketFactory factory;

    public HttpsServerNoCertImpl(int port) {
        super(port);
        init();
    }

    public HttpsServerNoCertImpl(int port, String bindingIP, int workerThreadLimit) {
        super(port, bindingIP, workerThreadLimit);
        init();
    }

    private void init() {
        try {
            //SSLContext.setDefault(SSLContext.getInstance("TLSv1.3"));
            this.factory = SSLServerSocketFactory.getDefault();
        } catch (Exception e) {
            throw new UncheckedIOException(new IOException(e));
        }
    }

    @Override
    protected ServerSocket createServerSocket() throws IOException {
        return factory.createServerSocket(this.getPort(), 0, InetAddress.getByName(this.getBindingIP()));
    }
}
