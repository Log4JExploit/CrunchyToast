/*
 * Copyright (c) 2024 CrunchyToast by Log4JExploit
 * Do you keep my non-compiled source code?
 * Then keep this comment.  (View the license)
 */

package github.log4jexploit.crunchytoast.http.message.impl;

import github.log4jexploit.crunchytoast.general.Client;
import github.log4jexploit.crunchytoast.http.message.body.inf.IBodyContentReader;
import github.log4jexploit.crunchytoast.http.message.body.inf.IBodyContentWriter;
import github.log4jexploit.crunchytoast.http.message.inf.HttpResponse;
import github.log4jexploit.crunchytoast.http.message.inf.Strategy;
import github.log4jexploit.crunchytoast.http.util.Http;
import github.log4jexploit.crunchytoast.strategy.StrategyResponseReceiveImpl;
import github.log4jexploit.crunchytoast.strategy.StrategyResponseSendImpl;


// Coded by Zadex at 21/10/2022
public final class HttpResponseImpl extends HttpMessageImpl implements HttpResponse {

    private Http.ResponseCode responseCode;
    private Strategy.Response strategy;


    public HttpResponseImpl() {
        responseCode = Http.ResponseCode.OK;
    }

    @Override
    public IBodyContentReader receive(Client client) {
        this.client = client;
        this.strategy = new StrategyResponseReceiveImpl();
        this.strategy.initialize(this.client, this);
        this.strategy.execute();
        return super.receive(this.client);
    }

    @Override
    public IBodyContentWriter send(Client client) {
        this.client = client;
        this.prepareSend();
        this.strategy = new StrategyResponseSendImpl();
        this.strategy.initialize(this.client, this);
        this.strategy.execute();
        return super.send(this.client);
    }

    private void prepareSend() {
        if(this.getServer() == null)
            this.setServer("CrunchyToast");
    }

    @Override
    public Http.ResponseCode getResponseCode() {
        return responseCode;
    }

    @Override
    public void setResponseCode(Http.ResponseCode responseCode) {
        this.responseCode = responseCode;
    }
}
