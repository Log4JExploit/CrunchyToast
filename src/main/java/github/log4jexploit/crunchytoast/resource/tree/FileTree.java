/*
 * Copyright (c) 2022-2025 CrunchyToast by Log4JExploit
 * Do you keep my non-compiled source code?
 * Then keep this comment.  (View the license)
 */

package github.log4jexploit.crunchytoast.resource.tree;

import github.log4jexploit.crunchytoast.http.util.Http;
import github.log4jexploit.crunchytoast.resource.Resource;
import github.log4jexploit.crunchytoast.resource.ResourceDynamic;

import java.io.File;
import java.util.Arrays;
import java.util.List;
import java.util.Objects;

public class FileTree extends ResourceTree<File> {

    public FileTree(File resourceFolder) {
        super(resourceFolder);
    }

    @Override
    public List<File> mapElements(File element) {
        if(element.isFile())
            return List.of();
        File[] files = element.listFiles();
        if(files == null || files.length == 0)
            return List.of();
        return Arrays.asList(files);
    }

    @Override
    public String mapName(File element) {
        return Objects.requireNonNull(element).getName();
    }

    @Override
    public Resource mapResource(File element) {
        return new ResourceDynamic(
                element,
                Http.ContentType.byFile(
                        mapName(element)
                )
        );
    }
}
