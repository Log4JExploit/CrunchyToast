/*
 * Copyright (c) 2024 CrunchyToast by Log4JExploit
 * Do you keep my non-compiled source code?
 * Then keep this comment.  (View the license)
 */

package github.log4jexploit.crunchytoast.http.resource;

import github.log4jexploit.crunchytoast.http.endpoint.HttpResource;
import github.log4jexploit.crunchytoast.http.util.Http;

import java.io.ByteArrayInputStream;
import java.io.InputStream;

public class HttpResourceBuffered implements HttpResource {

    private final byte[] data;
    private final Http.ContentType contentType;


    public HttpResourceBuffered(byte[] data, Http.ContentType contentType) {
        this.data = data;
        this.contentType = contentType;
    }

    @Override
    public long getSize() {
        return this.data.length;
    }

    public Http.ContentType getContentType() {
        return contentType;
    }

    @Override
    public byte[] getData() {
        return data;
    }

    @Override
    public byte[] getDataRange(long offset, int length) {
        int crampedLength = Math.min(length, (int)(this.getSize() - offset));
        byte[] buffer = new byte[crampedLength];
        System.arraycopy(this.data, (int)offset, buffer, 0, crampedLength);
        return buffer;
    }

    @Override
    public InputStream getDataAsStream() {
        return new ByteArrayInputStream(this.data);
    }

    @Override
    public boolean isSizeKnown() {
        return true;
    }
}
