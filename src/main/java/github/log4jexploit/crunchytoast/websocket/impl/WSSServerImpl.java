/*
 * Copyright (c) 2022-2025 CrunchyToast by Log4JExploit
 * Do you keep my non-compiled source code?
 * Then keep this comment.  (View the license)
 */

package github.log4jexploit.crunchytoast.websocket.impl;

import github.log4jexploit.crunchytoast.cert.CertManager;
import github.log4jexploit.crunchytoast.cert.CertManagerImpl;

import java.io.IOException;

public final class WSSServerImpl extends WSServer {


    private final CertManager certManager;


    public WSSServerImpl(int port) {
        this(port, "127.0.0.1");
    }

    public WSSServerImpl(int port, String bindingIP) {
        super(port, bindingIP);
        this.certManager = new CertManagerImpl();
    }


    @Override
    void createServerSocket() throws IOException {
        logger.debug("--- SECURITY INFO ---");
        logger.debug("TLS:");
        logger.debug("TLS Version: TLSv1.3");
        logger.debug("Supported Ciphers: TLS_AES_128_GCM_SHA256, TLS_AES_256_GCM_SHA384, TLS_RSA_WITH_AES_128_CBC_SHA256");
        logger.debug("Supported Application Protocols: Http/1.1");
        logger.debug("Endpoint Identification Algorithm: HTTPS");
        logger.debug("");
        logger.debug("Certificates: ");
        logger.debug("The 'certificates' folder has to contain two files: 'cert.pem' and 'key.pem'");
        logger.debug("The 'key.pem' file has to be formatted as PKCS8, unencrypted, containing the private key");
        logger.debug("The 'cert.pem' file has to be a X509 certificate and needs to be formatted as PEM");
        logger.debug("");
        logger.debug("Credit:");
        logger.debug("Author: Log4JExploit");
        logger.debug("Github Repository: https://github.com/Log4JExploit/CrunchyToast/");
        logger.debug("");
        logger.debug("--- SECURITY INFO ---");

        this.certManager.createFactory();
        this.serverSocket = this.certManager.getServerSocketFactory().createServerSocket(super.getPort());
    }
}
